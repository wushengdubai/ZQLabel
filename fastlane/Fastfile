desc 'ManagerLib ä½¿ç”¨è¿™ä¸ªèˆªé“ï¼Œå¯ä»¥å¿«é€Ÿç®¡ç†è‡ªå·±çš„åº“çš„å‡çº§ç»´æŠ¤ã€‚ä½¿ç”¨ï¼šfastlane ManagerLib tag:0.1.0'
lane :ManagerLib do |options|

tagName = options[:tag]
# target.podspec
targetName = options[:target]

# å…·ä½“è¿™ä¸ªèˆªé“çš„actions

#0 ä¿®æ”¹podspecçš„version
version = version_bump_podspec(path: "ZQLabel.podspec", version_number: tagName)

# 1. pod install
cocoapods(
    clean: true,
    podfile: "./Example/Podfile"
)

# 2. git add .
git_add(path: ".")
#    git commit -m "xxxx"
git_commit(path: ".", message: "ç‰ˆæœ¬#{tagName} å‡çº§ç»´æŠ¤")
#    git push origin master
push_to_git_remote

# 3.1 git tag æ ‡ç­¾åç§°ï¼Œå¦‚æœå­˜åœ¨ï¼Œåˆ™åˆ é™¤
if git_tag_exists(tag: tagName)
# æ‰§è¡Œåˆ é™¤æ ‡ç­¾
  UI.message("å‘ç° #{tagName} å·²ç»å­˜åœ¨ï¼Œå³å°†åˆ é™¤ ğŸš€")
remove_tag(tag: tagName)
end

# 3.2 æ–°å¢æ ‡ç­¾
add_git_tag(
tag: tagName
)
#    git push --tags
push_git_tags

# 4.pod spec lint
pod_lib_lint(allow_warnings: true)
#   pod trunk push xxx.podspec æäº¤åˆ°å…¬æœ‰åº“
pod_push(allow_warnings: true)

#   pod repo push XXX xxx.podspec æäº¤åˆ°ç§æœ‰åº“
#pod_push(path: "#{targetName}.podspec", repo: "ZQLabel", allow_warnings: true)


end
